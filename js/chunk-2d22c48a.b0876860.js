(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c48a"],{f329:function(t,e,o){"use strict";o.r(e);var n=o("7a23"),c={class:"container"},a={class:"topic"},u=Object(n["h"])("h2",null,"優惠券",-1),l={class:"text-end mt-4"},s={class:"table mt-4"},i=Object(n["h"])("thead",null,[Object(n["h"])("tr",null,[Object(n["h"])("th",null,"名稱"),Object(n["h"])("th",null,"折扣百分比"),Object(n["h"])("th",null,"到期日"),Object(n["h"])("th",null,"是否啟用"),Object(n["h"])("th",null,"編輯")])],-1),d={key:0,class:"noProduct"},p=Object(n["h"])("td",{colspan:"5"},"未有優惠劵",-1),b={key:0,class:"text-success"},h={key:1,class:"text-muted"},r={class:"btn-group"},m={class:"d-flex justify-content-center"};function O(t,e,o,O,j,f){var C=Object(n["C"])("Pagination"),v=Object(n["C"])("CouponModal");return Object(n["v"])(),Object(n["e"])(n["a"],null,[Object(n["h"])("div",c,[Object(n["h"])("section",a,[u,Object(n["h"])("div",l,[Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=function(t){return f.openModal("isNew")})}," 建立新的優惠券 ")]),Object(n["h"])("table",s,[i,Object(n["h"])("tbody",null,[0===j.coupons.length?(Object(n["v"])(),Object(n["e"])("tr",d,[p])):(Object(n["v"])(!0),Object(n["e"])(n["a"],{key:1},Object(n["A"])(j.coupons,(function(t){return Object(n["v"])(),Object(n["e"])("tr",{key:t.id},[Object(n["h"])("td",null,Object(n["F"])(t.title),1),Object(n["h"])("td",null,Object(n["F"])(t.percent)+"%",1),Object(n["h"])("td",null,Object(n["F"])("".concat(f.dateFormat(t.due_date))),1),Object(n["h"])("td",null,[t.is_enabled?(Object(n["v"])(),Object(n["e"])("span",b,"啟用")):(Object(n["v"])(),Object(n["e"])("span",h,"未啟用"))]),Object(n["h"])("td",null,[Object(n["h"])("div",r,[Object(n["h"])("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:function(e){return f.openModal("edit",t)}}," 編輯 ",8,["onClick"]),Object(n["h"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return f.deleteCoupons(t.id)}}," 刪除 ",8,["onClick"])])])])})),128))])])]),Object(n["h"])("div",m,[Object(n["h"])(C,{pagination:j.pagination,onPage:f.getCoupons},null,8,["pagination","onPage"])])]),Object(n["h"])(v,{ref:"couponModal",coupon:j.tempCoupon,status:j.couponModalStatus,onNewCoupon:f.getCoupons,onEditCoupon:f.getCoupons},null,8,["coupon","status","onNewCoupon","onEditCoupon"])],64)}var j=o("5530"),f=(o("99af"),{class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"}),C={class:"modal-dialog",role:"document"},v={class:"modal-content"},g={class:"modal-header"},y={class:"modal-title",id:"exampleModalLabel"},k={key:0},w={key:1},M=Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),_={class:"modal-body"},x={class:"mb-3"},S=Object(n["h"])("label",{for:"title"},"標題",-1),$={class:"mb-3"},N=Object(n["h"])("label",{for:"coupon_code"},"優惠碼",-1),J={class:"mb-3"},F=Object(n["h"])("label",{for:"due_date"},"到期日",-1),P={class:"mb-3"},U=Object(n["h"])("label",{for:"price"},"折扣百分比",-1),V={class:"mb-3"},D={class:"form-check"},E=Object(n["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),L={class:"modal-footer"},q=Object(n["h"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function A(t,e,o,c,a,u){return Object(n["v"])(),Object(n["e"])("div",f,[Object(n["h"])("div",C,[Object(n["h"])("div",v,[Object(n["h"])("div",g,[Object(n["h"])("h5",y,["isNew"===a.modalStatus?(Object(n["v"])(),Object(n["e"])("span",k,"新增優惠卷")):(Object(n["v"])(),Object(n["e"])("span",w,"編輯優惠卷"))]),M]),Object(n["h"])("div",_,[Object(n["h"])("div",x,[S,Object(n["O"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.tempCoupon.title=t})},null,512),[[n["J"],a.tempCoupon.title]])]),Object(n["h"])("div",$,[N,Object(n["O"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"coupon_code",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[2]||(e[2]=function(t){return a.tempCoupon.code=t})},null,512),[[n["J"],a.tempCoupon.code]])]),Object(n["h"])("div",J,[F,Object(n["O"])(Object(n["h"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":e[3]||(e[3]=function(t){return a.due_date=t})},null,512),[[n["J"],a.due_date]])]),Object(n["h"])("div",P,[U,Object(n["O"])(Object(n["h"])("input",{type:"number",class:"form-control",id:"price",min:"0",placeholder:"請輸入折扣百分比","onUpdate:modelValue":e[4]||(e[4]=function(t){return a.tempCoupon.percent=t})},null,512),[[n["J"],a.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["h"])("div",V,[Object(n["h"])("div",D,[Object(n["O"])(Object(n["h"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":e[5]||(e[5]=function(t){return a.tempCoupon.is_enabled=t})},null,512),[[n["I"],a.tempCoupon.is_enabled]]),E])])]),Object(n["h"])("div",L,[q,"isNew"===a.modalStatus?(Object(n["v"])(),Object(n["e"])("button",{key:0,type:"button",class:"btn btn-primary",onClick:e[6]||(e[6]=function(t){return u.submitCoupon(a.tempCoupon.id)})}," 新增優惠券 ")):(Object(n["v"])(),Object(n["e"])("button",{key:1,type:"button",class:"btn btn-primary",onClick:e[7]||(e[7]=function(t){return u.submitCoupon(a.tempCoupon.id)})}," 更新優惠券 "))])])])],512)}var I=o("3dea"),T=o.n(I),z={props:{coupon:{type:Object,default:function(){return{}}},status:{type:String,required:!0}},data:function(){return{modal:"",modalStatus:"",tempCoupon:{},due_date:""}},watch:{coupon:function(){this.tempCoupon=this.coupon},due_date:function(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)},status:function(){this.modalStatus=this.status}},methods:{openModal:function(){this.modal.show()},closeModal:function(){this.modal.hide()},submitCoupon:function(t){"isNew"===this.modalStatus?this.newCoupon():"edit"===this.modalStatus&&this.editCoupon(t)},newCoupon:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiang666","/admin/coupon");this.$http.post(e,{data:this.tempCoupon}).then((function(e){e.data.success?(alert(e.data.message),t.$emit("newCoupon"),t.closeModal(),t.tempCoupon={}):alert(e.data.message)})).catch((function(t){console.log(t)}))},editCoupon:function(t){var e=this,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiang666","/admin/coupon/").concat(t);this.$http.put(o,{data:this.tempCoupon}).then((function(t){console.log(t),t.data.success?(alert(t.data.message),e.closeModal(),e.$emit("editCoupon")):alert(t.data.message)})).catch((function(t){console.log(t)}))}},mounted:function(){this.modal=new T.a(this.$refs.modal)}};z.render=A;var B=z,G=o("1799"),H={components:{CouponModal:B,Pagination:G["a"]},inject:["dateFormat"],data:function(){return{coupons:[],couponModalStatus:"",tempCoupon:{},pagination:{}}},methods:{getCoupons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiang666","/admin/coupons?page=").concat(e);this.$http.get(o).then((function(e){e.data.success?(t.coupons=e.data.coupons,t.pagination=e.data.pagination):alert("請重新載入")})).catch((function(t){console.log(t)}))},openModal:function(t,e){"isNew"===t?this.tempCoupon={due_date:(new Date).getTime()/1e3}:"edit"===t&&(this.tempCoupon=Object(j["a"])({},e)),this.couponModalStatus=t,this.$refs.couponModal.openModal()},deleteCoupons:function(t){var e=this,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("chiang666","/admin/coupon/").concat(t);this.$http.delete(o).then((function(t){t.data.success?(alert(t.data.message),e.getCoupons()):alert(t.data.message)})).catch((function(t){console.log(t)}))}},created:function(){this.getCoupons()}};H.render=O;e["default"]=H}}]);
//# sourceMappingURL=chunk-2d22c48a.b0876860.js.map